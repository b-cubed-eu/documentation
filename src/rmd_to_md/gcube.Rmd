---
title: "gcube - R Markdown to Markdown Conversion"
author: "Sanne Govaert"
date: "`r Sys.Date()`"
output: html_document
---

# Overview

This document provides a guide for converting R Markdown files to Markdown format for the `gcube` package. The process involves downloading `.Rmd` files from a repository, transforming them to `.md` files, and organizing associated figures for the documentation website.

## Setup

The following code sets up the required environment to work with the `gcube` package and other essential libraries.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Install the gcube package
# Uncomment the line below to install the gcube package from its repository
# install.packages("gcube", repos = "https://b-cubed-eu.r-universe.dev")

# Load required libraries
library(gcube)
library(sf)      # working with spatial objects
library(dplyr)   # data wrangling
library(ggplot2) # visualisation with ggplot
```

## R Markdown Files

A list of `.Rmd` files is specified for processing. Each file corresponds to a specific section in the documentation.

```{r}
rmd_files <- list(
  list(
    rmd_file = "https://raw.githubusercontent.com/b-cubed-eu/gcube/refs/heads/main/README.Rmd", # md also available
    title = "Introduction",
    sidebar_label = "Introduction"
  ),
  list(
    rmd_file = "https://raw.githubusercontent.com/b-cubed-eu/gcube/refs/heads/main/vignettes/articles/occurrence-process.Rmd",
    title = "1. Simulating the occurrence process",
    sidebar_label = "Occurrence process"
  ),
  list(
    rmd_file = "https://raw.githubusercontent.com/b-cubed-eu/gcube/refs/heads/main/vignettes/articles/detection-process.Rmd",
    title = "2. Simulating the detection process",
    sidebar_label = "Detection process"
  ),
  list(
    rmd_file = "https://raw.githubusercontent.com/b-cubed-eu/gcube/refs/heads/main/vignettes/articles/grid-designation-process.Rmd",
    title = "3. Specifying the grid designation process",
    sidebar_label = "Grid designation process"
  ),
  list(
    rmd_file = "https://raw.githubusercontent.com/b-cubed-eu/gcube/refs/heads/main/vignettes/articles/multi-species-approach.Rmd",
    title = "4. Creating cubes for multiple species",
    sidebar_label = "Multi-species approach"
  )
)
```

## Converting R Markdown to Markdown

The following code automates the conversion of `.Rmd` files into `.md` format. Additionally, it organizes figures into directories for easy integration with documentation tools.

```{r}
md_dir <- here::here("src", "content", "docs", "software", "gcube")
fig_dir <- here::here("public", "software", "gcube")
fig_url_dir <- "/software/gcube/"

purrr::walk(
  rmd_files,
  ~ b3doc::rmd_to_md(
    .x$rmd_file,
    md_dir,
    fig_dir,
    fig_url_dir,
    title = .x$title,
    sidebar_label = .x$sidebar_label,
    sidebar_order = which(purrr::map_chr(rmd_files, "rmd_file") == .x$rmd_file)
  )
)
```

